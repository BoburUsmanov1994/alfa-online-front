"use strict";(self.webpackChunkalfa_invest=self.webpackChunkalfa_invest||[]).push([[497],{9497:(e,a,s)=>{s.r(a),s.d(a,{default:()=>E});var t=s(168),r=s(2791),n=s(8789),i=s(273),l=s(763),d=s(6953),o=s(2630),u=s(4653),m=s(4175),p=s(2250),c=s(967),x=s(4519),g=s(8720),h=s(5917),j=s(1550),b=s(9279),y=s(631),f=s(2703),Z=s(6591),k=s(7892),N=s.n(k),X=s(7689),q=s(3168),I=s(184);const J=(e,a)=>{if(!(0,l.isNil)(e)){if("day"==(0,l.get)(e,"prefix"))return N()(a).add((0,l.get)(e,"value")-1,(0,l.get)(e,"prefix")).toDate();if("month"==(0,l.get)(e,"prefix"))return N()(a).add((0,l.get)(e,"value"),(0,l.get)(e,"prefix")).subtract(1,"day").toDate();if("year"==(0,l.get)(e,"prefix"))return N()(a).add((0,l.get)(e,"value"),(0,l.get)(e,"prefix")).subtract(1,"day").toDate()}return N()()},S=e=>{let{...a}=e;const[s,t]=(0,r.useState)(null),[n,k]=(0,r.useState)(null),[S,C]=(0,r.useState)("organization"),[z,E]=(0,r.useState)(null),[v,D]=(0,r.useState)(null),[V,L]=(0,r.useState)(null),[F,P]=(0,r.useState)(null),[w,W]=(0,r.useState)(null),[M,T]=(0,r.useState)(null),[R,_]=(0,r.useState)(null),[A,K]=(0,r.useState)(0),[O,Y]=(0,r.useState)(null),[G,$]=(0,r.useState)(N()()),[B,H]=(0,r.useState)(0),[Q,U]=(0,r.useState)(5),[ee,ae]=(0,r.useState)(0),se=(0,i.o)((e=>(0,l.get)(e,"setBreadcrumbs",(()=>{})))),te=(0,X.s0)(),re=(0,r.useMemo)((()=>[{id:1,title:"OSGOR",path:"/osgor"},{id:2,title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c OSGOR",path:"/osgor/create"}]),[]),{t:ne}=(0,q.$)();(0,r.useEffect)((()=>{se(re)}),[]);const{data:ie,isLoading:le}=(0,j.i7)({key:b.t.insuranceTerms,url:y.n.insuranceTerms}),de=(0,f.WZ)((0,l.get)(ie,"data.result",[]),"id","name"),{data:oe,isLoading:ue}=(0,j.i7)({key:b.t.regions,url:y.n.regions}),me=(0,f.WZ)((0,l.get)(oe,"data.result",[]),"id","name"),{data:pe}=(0,j.i7)({key:b.t.genders,url:y.n.genders}),ce=(0,f.WZ)((0,l.get)(pe,"data.result",[]),"id","name"),{data:xe}=(0,j.i7)({key:b.t.okeds,url:y.n.okeds}),ge=(0,f.WZ)((0,l.get)(xe,"data.result",[]),"id","name"),{data:he}=(0,j.i7)({key:b.t.ownershipForms,url:y.n.ownershipForms}),je=(0,f.WZ)((0,l.get)(he,"data.result",[]),"id","name"),{data:be}=(0,j.i7)({key:[b.t.districts,w],url:y.n.districts,params:{params:{region:w}},enabled:!(!w&&!(0,l.get)(s,"regionId"))}),ye=(0,f.WZ)((0,l.get)(be,"data.result",[]),"id","name"),{data:fe}=(0,j.i7)({key:[b.t.activityAndRisk,R],url:y.n.activityAndRisk,params:{params:{oked:R}},enabled:!!R}),{mutate:Ze,isLoading:ke}=(0,j.n7)({listKeyId:b.t.personalInfoProvider}),{mutate:Ne,isLoading:Xe}=(0,j.n7)({listKeyId:b.t.organizationInfoProvider}),{mutate:qe}=(0,j.n7)({listKeyId:b.t.osgorCalculate,hideSuccessToast:!0}),{mutate:Ie}=(0,j.n7)({listKeyId:b.t.osgorCreate});return(0,r.useEffect)((()=>{O&&A&&M&&qe({url:y.n.osgorCalculate,attributes:{risk:O,fot:A,insuranceTermId:M}},{onSuccess:e=>{let{data:a}=e;H((0,l.get)(a,"result"))}})}),[O,A,M]),ue?(0,I.jsx)(Z.E,{}):(0,I.jsxs)(I.Fragment,{children:[(ke||Xe)&&(0,I.jsx)(Z.E,{}),(0,I.jsx)(d.Z,{children:(0,I.jsx)(u.X2,{children:(0,I.jsx)(u.JX,{xs:12,children:(0,I.jsx)(o.Z,{})})})}),(0,I.jsx)(m.Z,{children:(0,I.jsx)(u.X2,{children:(0,I.jsx)(u.JX,{xs:12,children:(0,I.jsxs)(x.Z,{formRequest:e=>{let{data:a}=e;const{activityRisk:s,birthDate:t,fot:r,funeralExpensesSum:n,passportNumber:i,passportSeries:d,rewardPercent:o,rewardSum:u,risk:m,rpmPercent:p,rpmSum:c,policies:x,agentId:g,insurant:h,...j}=a;Ie({url:y.n.osgorCreate,attributes:{insurant:(0,l.isEqual)(S,"person")?{person:{passportData:(0,l.get)(h,"person.passportData"),fullName:(0,l.get)(h,"person.fullName"),regionId:(0,l.get)(h,"person.regionId"),districtId:(0,l.get)(h,"person.districtId"),gender:(0,l.get)(h,"person.gender"),birthDate:(0,l.get)(h,"person.birthDate"),address:(0,l.get)(h,"person.address"),residentType:(0,l.get)(h,"person.residentType"),phone:(0,l.get)(h,"person.phone")}}:{organization:{...(0,l.get)(h,"organization"),oked:String((0,l.get)(h,"organization.oked"))}},...j}},{onSuccess:e=>{let{data:a}=e;(0,l.get)(a,"result.osgor_formId")?te("/osgor/view/".concat((0,l.get)(a,"result.osgor_formId"))):te("/osgor/list")}})},getValueFromField:(e,a)=>((e,a)=>{((0,l.isEqual)(e,"insurant.organization.regionId")||(0,l.isEqual)(e,"insurant.person.regionId"))&&W(a),(0,l.isEqual)(e,"insurant.organization.oked")&&_(a),(0,l.isEqual)(e,"policies[0].risk")&&Y(a),(0,l.isEqual)(e,"insurant.person.oked")&&_(a),(0,l.isEqual)(e,"policies[0].insuranceTermId")&&T(a)})(a,e),footer:(0,I.jsxs)(g.Z,{className:"mt-32",children:[(0,I.jsx)(c.Z,{onClick:()=>te("/osgor"),danger:!0,type:"button",className:"mr-16",children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,I.jsx)(c.Z,{type:"submit",className:"mr-16",children:"\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"})]}),children:[(0,I.jsxs)(u.X2,{gutterWidth:60,className:"mt-15",children:[(0,I.jsx)(u.JX,{xs:12,className:"mb-25",children:(0,I.jsx)(p.Z,{children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0442\u0440\u0430\u0445\u043e\u0432\u0430\u0442\u0435\u043b\u0435:"})}),(0,I.jsx)(u.JX,{xs:12,children:(0,I.jsxs)(u.X2,{children:[(0,I.jsx)(u.JX,{xs:4,children:(0,I.jsxs)(g.Z,{children:[(0,I.jsx)("h4",{className:"mr-16",children:"\u0421\u0442\u0440\u0430\u0445\u043e\u0432\u0430\u0442\u0435\u043b\u044c"}),(0,I.jsx)(c.Z,{onClick:()=>C("person"),gray:!(0,l.isEqual)(S,"person"),className:"mr-16",type:"button",children:"\u0424\u0438\u0437. \u043b\u0438\u0446\u043e"}),(0,I.jsx)(c.Z,{onClick:()=>C("organization"),gray:!(0,l.isEqual)(S,"organization"),type:"button",children:"\u042e\u0440. \u043b\u0438\u0446\u043e"})]})}),(0,I.jsxs)(u.JX,{xs:8,className:"text-right",children:[(0,l.isEqual)(S,"person")&&(0,I.jsxs)(g.Z,{justify:"flex-end",children:[(0,I.jsx)(h.Z,{params:{required:!0},className:"mr-16",style:{width:75},property:{hideLabel:!0,mask:"aa",placeholder:"AA",upperCase:!0,maskChar:"_",onChange:e=>E((0,l.upperCase)(e))},name:"insurant.person.passportData.seria",type:"input-mask"}),(0,I.jsx)(h.Z,{params:{required:!0},property:{hideLabel:!0,mask:"9999999",placeholder:"1234567",maskChar:"_",onChange:e=>D(e)},name:"insurant.person.passportData.number",type:"input-mask"}),(0,I.jsx)(h.Z,{params:{required:!0},className:"ml-15",property:{hideLabel:!0,placeholder:"\u0414\u0430\u0442\u0430 \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f",onChange:e=>L(e)},name:"insurant.person.birthDate",type:"datepicker"}),(0,I.jsx)(c.Z,{onClick:()=>{Ze({url:y.n.personalInfoProvider,attributes:{birthDate:N()(V).format("YYYY-MM-DD"),passportSeries:z,passportNumber:v}},{onSuccess:e=>{let{data:a}=e;t((0,l.get)(a,"result"))}})},className:"ml-15",type:"button",children:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435"})]}),(0,l.isEqual)(S,"organization")&&(0,I.jsxs)(g.Z,{justify:"flex-end",children:[(0,I.jsx)(h.Z,{params:{required:!0},property:{hideLabel:!0,mask:"999999999",placeholder:"Inn",maskChar:"_",onChange:e=>P(e)},name:"insurant.organization.inn",type:"input-mask"}),(0,I.jsx)(c.Z,{onClick:()=>{Ne({url:y.n.organizationInfoProvider,attributes:{inn:F}},{onSuccess:e=>{let{data:a}=e;k((0,l.get)(a,"result"))}})},className:"ml-15",type:"button",children:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435"})]})]})]})}),(0,I.jsx)(u.JX,{xs:12,children:(0,I.jsx)("hr",{className:"mt-15 mb-15"})}),(0,l.isEqual)(S,"person")&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},defaultValue:(0,l.get)(s,"firstNameLatin"),label:"Firstname",type:"input",name:"insurant.person.fullName.firstname"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},defaultValue:(0,l.get)(s,"lastNameLatin"),label:"Lastname",type:"input",name:"insurant.person.fullName.lastname"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},defaultValue:(0,l.get)(s,"middleNameLatin"),label:"Middlename",type:"input",name:"insurant.person.fullName.middlename"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{defaultValue:(0,l.get)(s,"pinfl"),label:"\u041f\u0418\u041d\u0424\u041b",type:"input",name:"insurant.person.passportData.pinfl"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},defaultValue:(0,l.get)(s,"gender"),options:ce,label:"Gender",type:"select",name:"insurant.person.gender"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},options:me,defaultValue:(0,l.get)(s,"regionId"),label:"Region",type:"select",name:"insurant.person.regionId"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},options:ye,defaultValue:(0,l.get)(s,"districtId"),label:"District",type:"select",name:"insurant.person.districtId"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},defaultValue:(0,l.get)(s,"address"),label:"Address",type:"input",name:"insurant.person.address"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0,pattern:{value:/^998(9[012345789]|6[125679]|7[01234569])[0-9]{7}$/,message:"Invalid format"}},defaultValue:(0,l.get)(s,"phone"),label:"Phone",type:"input",property:{placeholder:"998XXXXXXXXX"},name:"insurant.person.phone"})})]}),(0,l.isEqual)(S,"organization")&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.JX,{xs:4,children:(0,I.jsx)(h.Z,{label:"\u0424\u043e\u0440\u043c\u0430 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438",params:{required:!0},options:je,type:"select",name:"insurant.organization.ownershipFormId"})}),(0,I.jsx)(u.JX,{xs:8,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},defaultValue:(0,l.get)(n,"name"),label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",type:"input",name:"insurant.organization.name"})}),(0,I.jsx)(u.JX,{xs:4,children:(0,I.jsx)(h.Z,{label:"\u041e\u0431\u043b\u0430\u0441\u0442\u044c",params:{required:!0},options:me,type:"select",name:"insurant.organization.regionId"})}),(0,I.jsx)(u.JX,{xs:4,children:(0,I.jsx)(h.Z,{label:"\u0420\u0430\u0439\u043e\u043d",params:{required:!0},options:ye,type:"select",name:"insurant.organization.districtId"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{defaultValue:(0,l.get)(n,"address"),params:{required:!0},label:"Address",type:"input",name:"insurant.organization.address"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{defaultValue:(0,l.get)(n,"phone"),params:{required:!0,pattern:/^998(9[012345789]|6[125679]|7[01234569])[0-9]{7}$/},label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",type:"input",name:"insurant.organization.phone"})})]})]}),(0,I.jsxs)(u.X2,{gutterWidth:60,className:"mt-15",children:[(0,I.jsx)(u.JX,{xs:12,className:"mb-25",children:(0,I.jsx)(p.Z,{children:"\u0414\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c:"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},options:ge,defaultValue:parseInt((0,l.get)(n,"oked")),label:"\u041e\u041a\u042d\u0414",type:"select",name:"insurant.organization.oked"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{params:{required:!0},options:(0,f.WZ)((0,l.get)(fe,"data.result.risks",[]),"number","number"),label:"\u041a\u043b\u0430\u0441\u0441 \u043f\u0440\u043e\u0444. \u0440\u0438\u0441\u043a\u0430",type:"select",name:"policies[0].risk"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{property:{onChange:e=>K(e)},label:"\u0424\u043e\u043d\u0434 \u043e\u043f\u043b\u0430\u0442\u044b \u0442\u0440\u0443\u0434\u0430",type:"number-format-input",name:"policies[0].fot"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{options:de,params:{required:!0},label:"\u0421\u0440\u043e\u043a \u0441\u0442\u0440\u0430\u0445\u043e\u0432\u0430\u043d\u0438\u044f",type:"select",name:"policies[0].insuranceTermId"})}),(0,I.jsx)(u.JX,{xs:4,className:"mb-25",children:(0,I.jsx)(h.Z,{label:"\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u043e\u043b\u0438\u0441\u0430",params:{required:!0},property:{onChange:e=>$(e),dateFormat:"dd.MM.yyyy"},type:"datepicker",name:"policies[0].startDate"})}),(0,I.jsx)(u.JX,{xs:4,children:(0,I.jsx)(h.Z,{label:"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u043f\u043e\u043b\u0438\u0441\u0430 ",params:{required:!0},defaultValue:J((0,l.find)((0,l.get)(ie,"data.result",[]),(e=>(0,l.get)(e,"id")==M)),G),disabled:!(0,l.isEqual)(M,6),property:{dateFormat:"dd.MM.yyyy"},type:"datepicker",name:"policies[0].endDate"})}),(0,I.jsx)(u.JX,{xs:6,className:"mb-25",children:(0,I.jsx)(h.Z,{defaultValue:(0,l.get)(B,"insuranceSum"),property:{disabled:!0},label:"\u041e\u0431\u0449\u0430\u044f \u0441\u0442\u0440\u0430\u0445\u043e\u0432\u0430\u044f \u0441\u0443\u043c\u043c\u0430:",type:"number-format-input",name:"policies[0].insuranceSum"})}),(0,I.jsx)(u.JX,{xs:6,className:"mb-25",children:(0,I.jsx)(h.Z,{defaultValue:(0,l.get)(B,"insurancePremium"),property:{disabled:!0},label:"\u041e\u0431\u0449\u0430\u044f \u0441\u0442\u0440\u0430\u0445\u043e\u0432\u0430\u044f \u043f\u0440\u0435\u043c\u0438\u044f:",type:"number-format-input",name:"policies[0].insurancePremium"})})]})]})})})})]})};var C;const z=n.ZP.div(C||(C=(0,t.Z)(["\n  .form-group {\n    margin-bottom: 0;\n  }\n\n"]))),E=e=>{let{...a}=e;return(0,I.jsx)(z,{...a,children:(0,I.jsx)(S,{})})}}}]);
//# sourceMappingURL=497.d4cfeaeb.chunk.js.map